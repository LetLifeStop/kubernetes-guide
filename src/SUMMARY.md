# Kubernetes 实践指南

[序言](README.md)

# 集群网络

- [常见问题](networking/faq/README.md)
  - [为什么要开 bridge-nf-call-iptables?](networking/faq/why-enable-bridge-nf-call-iptables.md)
  - [ipvs 连接复用引发的系列问题](networking/faq/ipvs-conn-reuse-mode.md)

# 实用技巧

- [高效使用 kubectl](trick/kubectl/README.md)
  - [使用 kubectl-aliases 缩短命令](trick/kubectl/kubectl-aliases.md)
  - [使用 kubectx 和 kubens 快速切换](trick/kubectl/quick-switch-with-kubectx.md)
  - [使用 kubecm 合并 kubeconfig](trick/kubectl/merge-kubeconfig-with-kubecm.md)
  - [使用 kubectl get --raw](trick/kubectl/kubectl-get-raw.md)
- [证书签发](trick/certs/README.md)
  - [使用 cfssl 生成证书](trick/certs/sign-certs-with-cfssl.md)
  - [使用 cert-manager 签发免费证书](trick/certs/sign-free-certs-with-cert-manager.md)
  - [为 dnspod 的域名签发免费证书](trick/certs/sign-free-certs-for-dnspod.md)
- [用户与权限](trick/user-and-permissions/README.md)
  - [使用 CSR API 创建用户](trick/user-and-permissions/create-user-using-csr-api.md)
- [部署与配置](trick/deploy/README.md)
  - [为 Pod 设置内核参数](trick/deploy/set-sysctl.md)

# 最佳实践

- [优雅终止](best-practices/graceful-shutdown/README.md)
  - [Pod 销毁流程](best-practices/graceful-shutdown/pod-termination-proccess.md)
  - [业务代码处理 SIGTERM 信号](best-practices/graceful-shutdown/code-example-of-handle-sigterm.md)
  - [为什么收不到 SIGTERM 信号?](best-practices/graceful-shutdown/why-cannot-receive-sigterm.md)
  - [在 SHELL 中传递信号](best-practices/graceful-shutdown/propagating-signals-in-shell.md)
  - [合理使用 preStop](best-practices/graceful-shutdown/use-prestop.md)
  - [长连接场景](best-practices/graceful-shutdown/persistent-connection.md)
  - [LB 直通 Pod 场景](best-practices/graceful-shutdown/lb-to-pod-directly.md)
- [健康检查配置](best-practices/configure-healthcheck.md)
- [Pod 性能优化](best-practices/performance-optimization/README.md)
  - [Pod 绑定 NUMA 亲和性](best-practices/performance-optimization/single-numa-node.md)
- [高可用部署](best-practices/ha/README.md)
  - [Pod 打散调度](best-practices/ha/pod-split-up-scheduling.md)
  - [安全维护或下线节点](best-practices/ha/securely-maintain-or-offline-node.md)
  - [工作负载平滑升级](best-practices/ha/smooth-upgrade.md)
- [CoreDNS](best-practices/coredns/README.md)
  - [CoreDNS 自定义域名解析](best-practices/coredns/customize-coredns-resolution.md)
  - [CoreDNS 性能优化](best-practices/coredns/optimize-coredns-performance.md)
- [弹性伸缩](best-practices/autoscaling/README.md)
  - [调节 HPA 扩缩容灵敏度](best-practices/autoscaling/hpa-velocity.md)
  - [HPA 使用自定义指标进行伸缩](best-practices/autoscaling/hpa-with-custom-metrics.md)
- [应用容器化](best-practices/containerization/README.md)
  - [在容器内使用 systemd](best-practices/containerization/systemd-in-container.md)
  - [Java 应用容器化](best-practices/containerization/java-container.md)
  
# 故障排查

- [排障技能](troubleshooting/skill/README.md)
  - [使用 nsenter 进入 netns 抓包](troubleshooting/skill/network/enter-netns-with-nsenter.md)
  - [使用 ksniff 远程抓包](troubleshooting/skill/network/remote-capture-with-ksniff.md)
  - [使用 Systemtap 定位疑难杂症](troubleshooting/skill/kernel/use-systemtap-to-locate-problems.md)
- [Pod 排障](troubleshooting/pod/README.md)
  - [一直 Terminating](troubleshooting/pod/pod-terminating.md)
    - [排查 device or resource busy](troubleshooting/pod/device-or-resource-busy.md)
  - [一直 Pending](troubleshooting/pod/pod-pending.md)
  - [一直 ContainerCreating 或 Waiting](troubleshooting/pod/pod-containercreating-or-waiting.md)
  - [CrashLoopBackOff](troubleshooting/pod/pod-crash.md)
  - [健康检查失败](troubleshooting/pod/healthcheck-failed.md)
- [节点排障](troubleshooting/node/README.md)
  - [节点 Crash 与 Vmcore 分析](troubleshooting/node/node-crash-and-vmcore.md)
  - [节点高负载](troubleshooting/node/node-high-load.md)
    - [IO 高负载](troubleshooting/node/io-high-load.md)
  - [内存碎片化](troubleshooting/node/memory-fragmentation.md)
  - [磁盘爆满](troubleshooting/node/disk-full.md)
  - [ARP 缓存爆满](troubleshooting/node/arp-cache-overflow.md)
- [网络排障](troubleshooting/network/README.md)
  - [排查超时](troubleshooting/network/timeout.md)
  - [排查丢包](troubleshooting/network/packet-loss.md)
  - [CLOSE_WAIT 堆积](troubleshooting/network/close-wait-stacking.md)
- [排障案例](troubleshooting/cases/README.md)
  - [运行时故障](troubleshooting/cases/runtime/README.md)
    - [磁盘 IO 过高导致 Pod 创建超时](troubleshooting/cases/runtime/io-high-load-causing-pod-creation-timeout.md)
    - [高版本 containerd 下载镜像失败](troubleshooting/cases/runtime/pull-image-fail-in-high-version-containerd.md)
    - [挂载根目录导致 device or resource busy](troubleshooting/cases/runtime/mount-root-causing-device-or-resource-busy.md)
    - [系统时间被修改导致 sandbox 冲突](troubleshooting/cases/runtime/broken-system-time-causing-sandbox-conflicts.md)
  - [网络故障](troubleshooting/cases/network/README.md)
    - [DNS 5 秒延时](troubleshooting/cases/network/dns-lookup-5s-delay.md)
  - [高负载](troubleshooting/cases/high-load/README.md)
    - [容器磁盘满导致 CPU 飙高](troubleshooting/cases/high-load/disk-full-causing-high-cpu.md)
  - [集群故障](troubleshooting/cases/cluster/README.md)
    - [误删 rancher 的 namespace 导致 node 被清空](troubleshooting/cases/cluster/delete-rancher-ns-causing-node-disappear.md)
    - [调度器 cache 快照遗漏部分信息导致 pod pending](troubleshooting/cases/cluster/scheduler-snapshot-missing-causing-pod-pending.md)
